<html>
<head>
    <title>main.py</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}


    </style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060">
    <tr>
        <td>
            <center>
                <font face="Arial, Helvetica" color="#000000">
                    main.py</font>
            </center>
        </td>
    </tr>
</table>
<pre><span class="s0">import </span><span class="s1">cvzone</span>
<span class="s0">import </span><span class="s1">cv2</span>
<span class="s0">from </span><span class="s1">cvzone.HandTrackingModule </span><span class="s0">import </span><span
            class="s1">HandDetector</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">time</span>


<span class="s2"># Parameters</span>
<span class="s1">width</span><span class="s0">, </span><span class="s1">height = </span><span
            class="s3">1280</span><span class="s0">, </span><span class="s3">720</span>
<span class="s1">gestureThreshold = </span><span class="s3">300</span>
<span class="s1">folderPath = </span><span class="s4">&quot;Presentation&quot;</span>

<span class="s1">blueLower = (</span><span class="s3">100</span><span class="s0">, </span><span
            class="s3">60</span><span class="s0">, </span><span class="s3">60</span><span class="s1">)</span>
<span class="s1">blueUpper = (</span><span class="s3">140</span><span class="s0">, </span><span
            class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s1">)</span>

<span class="s2"># Camera Setup</span>
<span class="s1">cap = cv2.VideoCapture(</span><span class="s4">&quot;http://192.168.1.108:8080/video&quot;</span><span
            class="s1">)</span>
<span class="s1">cap.set(</span><span class="s3">3</span><span class="s0">, </span><span class="s1">width)</span>
<span class="s1">cap.set(</span><span class="s3">4</span><span class="s0">, </span><span class="s1">height)</span>

<span class="s2"># Hand Detector</span>
<span class="s1">detectorHand = HandDetector(detectionCon=</span><span class="s3">0.8</span><span
            class="s0">, </span><span class="s1">maxHands=</span><span class="s3">1</span><span class="s1">)</span>

<span class="s2"># Variables</span>
<span class="s1">imgList = []</span>
<span class="s1">delay = </span><span class="s3">30</span>
<span class="s1">buttonPressed = </span><span class="s0">False</span>
<span class="s1">counter = </span><span class="s3">0</span>
<span class="s1">drawMode = </span><span class="s0">False</span>
<span class="s1">imgNumber = </span><span class="s3">0</span>
<span class="s1">delayCounter = </span><span class="s3">0</span>
<span class="s1">annotations = [[]]</span>
<span class="s1">annotationNumber = -</span><span class="s3">1</span>
<span class="s1">annotationStart = </span><span class="s0">False</span>
<span class="s1">hs</span><span class="s0">, </span><span class="s1">ws = int(</span><span class="s3">120 </span><span
            class="s1">* </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span
            class="s1">int(</span><span class="s3">213 </span><span class="s1">* </span><span class="s3">1</span><span
            class="s1">)  </span><span class="s2"># width and height of small image</span>
<span class="s1">hb</span><span class="s0">, </span><span class="s1">wb = int(</span><span class="s3">120 </span><span
            class="s1">* </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span
            class="s1">int(</span><span class="s3">213 </span><span class="s1">* </span><span class="s3">3</span><span
            class="s1">)</span>
<span class="s2"># Get list of presentation images</span>
<span class="s1">pathImages = sorted(os.listdir(folderPath)</span><span class="s0">, </span><span
            class="s1">key=len)</span>
<span class="s1">print(pathImages)</span>

<span class="s1">buttonTogglePressed = </span><span class="s0">False</span>


<span class="s0">while True</span><span class="s1">:</span>
    <span class="s2"># Get image frame</span>
    <span class="s1">success</span><span class="s0">, </span><span class="s1">img = cap.read()</span>
    <span class="s1">img = cv2.flip(img</span><span class="s0">, </span><span class="s3">1</span><span
            class="s1">)</span>


    <span class="s1">pathFullImage = os.path.join(folderPath</span><span class="s0">, </span><span class="s1">pathImages[imgNumber])</span>
    <span class="s1">imgCurrent = cv2.imread(pathFullImage)</span>


    <span class="s2"># Find the hand and its landmarks</span>
    <span class="s1">hands</span><span class="s0">, </span><span
            class="s1">img = detectorHand.findHands(img)  </span><span class="s2"># with draw</span>

    <span class="s2"># Draw Gesture Threshold line</span>
    <span class="s1">cv2.line(img</span><span class="s0">, </span><span class="s1">(</span><span
            class="s3">0</span><span class="s0">, </span><span class="s1">gestureThreshold)</span><span
            class="s0">, </span><span class="s1">(width</span><span class="s0">, </span><span class="s1">gestureThreshold)</span><span
            class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span
            class="s3">255</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span
            class="s0">, </span><span class="s3">5</span><span class="s1">)</span>

    <span class="s0">if </span><span class="s1">hands </span><span class="s0">and </span><span
            class="s1">buttonPressed </span><span class="s0">is False</span><span class="s1">:  </span><span class="s2"># If hand is detected</span>

        <span class="s1">hand = hands[</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">cx</span><span class="s0">, </span><span class="s1">cy = hand[</span><span class="s4">&quot;center&quot;</span><span
            class="s1">]</span>
        <span class="s1">lmList = hand[</span><span class="s4">&quot;lmList&quot;</span><span class="s1">]  </span><span
            class="s2"># List of 21 Landmark points</span>
        <span class="s1">fingers = detectorHand.fingersUp(hand)  </span><span
            class="s2"># List of which fingers are up</span>



        <span class="s2"># Constrain values for easier drawing</span>
        <span class="s1">xVal = int(np.interp(lmList[</span><span class="s3">8</span><span class="s1">][</span><span
            class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span
            class="s1">[width // </span><span class="s3">2</span><span class="s0">, </span><span
            class="s1">width]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span
            class="s0">, </span><span class="s1">width]))</span>
        <span class="s1">yVal = int(np.interp(lmList[</span><span class="s3">8</span><span class="s1">][</span><span
            class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span
            class="s3">150</span><span class="s0">, </span><span class="s1">height - </span><span
            class="s3">150</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span
            class="s3">0</span><span class="s0">, </span><span class="s1">height]))</span>
        <span class="s1">indexFinger = xVal</span><span class="s0">, </span><span class="s1">yVal</span>
        <span class="s0">if</span><span class="s1">(cx&lt;=</span><span class="s3">100 </span><span class="s1">&amp; cy &lt;=</span><span
            class="s3">100</span><span class="s1">):</span>
            <span class="s1">time.sleep(</span><span class="s3">1</span><span class="s1">)</span>
            <span class="s1">buttonTogglePressed = </span><span class="s0">not </span><span class="s1">buttonTogglePressed;</span>



        <span class="s0">if </span><span class="s1">cy &lt;= gestureThreshold :  </span><span class="s2"># If hand is at the height of the face</span>
            <span class="s0">if </span><span class="s1">fingers == [</span><span class="s3">1</span><span
            class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span
            class="s1">]:</span>
                <span class="s1">print(</span><span class="s4">&quot;Left&quot;</span><span class="s1">)</span>
                <span class="s1">buttonPressed = </span><span class="s0">True</span>
                <span class="s0">if </span><span class="s1">imgNumber &gt; </span><span class="s3">0</span><span
            class="s1">:</span>
                    <span class="s1">imgNumber -= </span><span class="s3">1</span>
                    <span class="s1">annotations = [[]]</span>
                    <span class="s1">annotationNumber = -</span><span class="s3">1</span>
                    <span class="s1">annotationStart = </span><span class="s0">False</span>
            <span class="s0">if </span><span class="s1">fingers == [</span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span
            class="s1">]:</span>
                <span class="s1">print(</span><span class="s4">&quot;Right&quot;</span><span class="s1">)</span>
                <span class="s1">buttonPressed = </span><span class="s0">True</span>
                <span class="s0">if </span><span class="s1">imgNumber &lt; len(pathImages) - </span><span
            class="s3">1</span><span class="s1">:</span>
                    <span class="s1">imgNumber += </span><span class="s3">1</span>
                    <span class="s1">annotations = [[]]</span>
                    <span class="s1">annotationNumber = -</span><span class="s3">1</span>
                    <span class="s1">annotationStart = </span><span class="s0">False</span>

        <span class="s0">if </span><span class="s1">fingers == [</span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span
            class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span
            class="s1">]:</span>
            <span class="s1">cv2.circle(imgCurrent</span><span class="s0">, </span><span
            class="s1">indexFinger</span><span class="s0">, </span><span class="s3">12</span><span
            class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span
            class="s3">0</span><span class="s0">, </span><span class="s3">255</span><span class="s1">)</span><span
            class="s0">, </span><span class="s1">cv2.FILLED)</span>

        <span class="s0">if </span><span class="s1">fingers == [</span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span
            class="s1">]:</span>
            <span class="s0">if </span><span class="s1">annotationStart </span><span class="s0">is False</span><span
            class="s1">:</span>
                <span class="s1">annotationStart = </span><span class="s0">True</span>
                <span class="s1">annotationNumber += </span><span class="s3">1</span>
                <span class="s1">annotations.append([])</span>
            <span class="s1">print(annotationNumber)</span>
            <span class="s1">annotations[annotationNumber].append(indexFinger)</span>
            <span class="s1">cv2.circle(imgCurrent</span><span class="s0">, </span><span
            class="s1">indexFinger</span><span class="s0">, </span><span class="s3">12</span><span
            class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span
            class="s3">0</span><span class="s0">, </span><span class="s3">255</span><span class="s1">)</span><span
            class="s0">, </span><span class="s1">cv2.FILLED)</span>

        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">annotationStart = </span><span class="s0">False</span>

        <span class="s0">if </span><span class="s1">fingers == [</span><span class="s3">0</span><span
            class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span
            class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span
            class="s1">]:</span>
            <span class="s0">if </span><span class="s1">annotations:</span>
                <span class="s1">annotations.pop(-</span><span class="s3">1</span><span class="s1">)</span>
                <span class="s1">annotationNumber -= </span><span class="s3">1</span>
                <span class="s1">buttonPressed = </span><span class="s0">True</span>

    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">annotationStart = </span><span class="s0">False</span>

    <span class="s0">if </span><span class="s1">buttonPressed:</span>
        <span class="s1">counter += </span><span class="s3">1</span>
        <span class="s0">if </span><span class="s1">counter &gt; delay:</span>
            <span class="s1">counter = </span><span class="s3">0</span>
            <span class="s1">buttonPressed = </span><span class="s0">False</span>

    <span class="s0">for </span><span class="s1">i</span><span class="s0">, </span><span
            class="s1">annotation </span><span class="s0">in </span><span class="s1">enumerate(annotations):</span>
        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(len(annotation)):</span>
            <span class="s0">if </span><span class="s1">j != </span><span class="s3">0</span><span class="s1">:</span>
                <span class="s1">cv2.line(imgCurrent</span><span class="s0">, </span><span
            class="s1">annotation[j - </span><span class="s3">1</span><span class="s1">]</span><span
            class="s0">, </span><span class="s1">annotation[j]</span><span class="s0">, </span><span class="s1">(</span><span
            class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span
            class="s3">200</span><span class="s1">)</span><span class="s0">, </span><span class="s3">12</span><span
            class="s1">)</span>

    <span class="s1">h</span><span class="s0">, </span><span class="s1">w</span><span class="s0">, </span><span
            class="s1">_ = imgCurrent.shape</span>


    <span class="s0">if </span><span class="s1">(buttonTogglePressed == </span><span class="s0">False</span><span
            class="s1">):</span>
        <span class="s1">imgSmall = cv2.resize(img</span><span class="s0">, </span><span class="s1">(ws</span><span
            class="s0">, </span><span class="s1">hs))</span>
        <span class="s1">imgCurrent[</span><span class="s3">0</span><span class="s1">:hs</span><span
            class="s0">, </span><span class="s1">w - ws: w] = imgSmall</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">imgnew = cv2.resize(img</span><span class="s0">, </span><span class="s1">(wb</span><span
            class="s0">, </span><span class="s1">hb))</span>
        <span class="s1">imgCurrent[</span><span class="s3">0</span><span class="s1">:hb</span><span
            class="s0">, </span><span class="s1">w - wb: w] = imgnew</span>



    <span class="s1">cv2.imshow(</span><span class="s4">&quot;Slides&quot;</span><span class="s0">, </span><span
            class="s1">imgCurrent)</span>
    <span class="s2">#cv2.imshow(&quot;Image&quot;, img)</span>

    <span class="s1">key = cv2.waitKey(</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s0">if </span><span class="s1">key == ord(</span><span class="s4">'q'</span><span class="s1">):</span>
        <span class="s0">break</span>
</pre>
</body>
</html>